<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Workshop Page - Mission Control V4</title>
  <link rel="stylesheet" href="../styles/main.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, var(--bg-deep) 0%, #0f1428 100%);
      color: var(--text-primary);
    }

    .layout {
      display: flex;
      height: 100vh;
    }

    .sidebar {
      width: 280px;
      background: rgba(15, 20, 40, 0.95);
      border-right: 1px solid var(--border-glass);
      padding: 24px 0;
      overflow-y: auto;
    }

    .sidebar h3 {
      padding: 0 16px;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      color: var(--text-tertiary);
      margin: 24px 0 12px 0;
    }

    .sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar a {
      display: block;
      padding: 12px 16px;
      color: var(--text-secondary);
      text-decoration: none;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }

    .sidebar a:hover,
    .sidebar a.active {
      color: var(--text-primary);
      background: rgba(255, 255, 255, 0.06);
      border-left-color: var(--accent-blue);
    }

    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .demo-info {
      padding: 12px 24px;
      background: rgba(34, 197, 94, 0.15);
      border-bottom: 1px solid rgba(34, 197, 94, 0.3);
      font-size: 13px;
      color: var(--text-secondary);
    }

    .demo-info strong {
      color: #22c55e;
    }
  </style>
</head>
<body>
  <div class="layout">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <h3>Navigation</h3>
      <ul>
        <li><a href="#" data-page="dashboard">‚äû Dashboard</a></li>
        <li><a href="#" data-page="journal">üìñ Journal</a></li>
        <li><a href="#" data-page="documents">üìÅ Documents</a></li>
        <li><a href="#" data-page="workshop" class="active">üîß Workshop</a></li>
      </ul>

      <h3>Status</h3>
      <div style="padding: 12px 16px;">
        <div style="font-size: 12px; color: #22c55e;">‚óè Online</div>
        <div style="font-size: 11px; color: var(--text-tertiary); margin-top: 4px;">Building Dashboard</div>
      </div>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
      <div class="demo-info">
        <strong>‚úì Workshop Page Loaded</strong> ‚Äî Three-column task queue with auto-pickup and live feed
      </div>

      <!-- Workshop Page Container -->
      <div id="workshopPageContainer" style="flex: 1; overflow: hidden;">
        <!-- Workshop page will be loaded here -->
      </div>
    </div>
  </div>

  <!-- Load Workshop Page -->
  <script type="module">
    import WorkshopManager from '../js/workshop-logic.js';

    // Load and inject the Workshop HTML
    async function loadWorkshop() {
      try {
        const response = await fetch('../pages/Workshop.html');
        const html = await response.text();
        
        // Create a temporary container to parse the HTML
        const temp = document.createElement('div');
        temp.innerHTML = html;
        
        // Extract the main element and inject into the page
        const workshopPage = temp.querySelector('main.workshop-page');
        const container = document.getElementById('workshopPageContainer');
        
        if (workshopPage && container) {
          container.appendChild(workshopPage);
          
          // Initialize the workshop manager
          console.log('‚úì Workshop page loaded');
          console.log('‚úì Workshop manager initializing...');
        }
      } catch (error) {
        console.error('Error loading workshop page:', error);
      }
    }

    // Load when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadWorkshop);
    } else {
      loadWorkshop();
    }

    // Global test API
    window.testWorkshop = {
      log: (msg) => console.log(`[Workshop Test] ${msg}`),
      info: () => {
        console.log('%c=== WORKSHOP TEST INFO ===', 'color: #3b82f6; font-weight: bold; font-size: 14px;');
        console.log('Files Created:');
        console.log('  ‚úì /src/pages/Workshop.html - 24K (Main page component)');
        console.log('  ‚úì /src/api/workshop.js - 12K (API mock with data)');
        console.log('  ‚úì /src/js/workshop-logic.js - 16K (Frontend logic & state)');
        console.log('');
        console.log('Features Implemented:');
        console.log('  ‚úì Three-column layout (Queued, Active, Completed)');
        console.log('  ‚úì Task detail modal with full information');
        console.log('  ‚úì Toggle between Queued view and Live Feed view');
        console.log('  ‚úì Auto-pickup logic (when Active empty, pull from Queued)');
        console.log('  ‚úì Search/filter functionality');
        console.log('  ‚úì Progress bar animations');
        console.log('  ‚úì Activity logs in modal');
        console.log('  ‚úì Mock data with 6 sample tasks');
        console.log('  ‚úì Live feed with event streaming');
        console.log('  ‚úì Auto-refresh every 5 seconds');
        console.log('  ‚úì Responsive design (desktop/tablet/mobile)');
        console.log('');
        console.log('API Endpoints (Mock):');
        console.log('  ‚úì getTasks() - Get all tasks by status');
        console.log('  ‚úì createTask(data) - Create new task');
        console.log('  ‚úì updateTask(id, updates) - Update task');
        console.log('  ‚úì startTask(id) - Move from Queued to Active');
        console.log('  ‚úì completeTask(id) - Move from Active to Completed');
        console.log('  ‚úì deleteTask(id) - Delete task');
        console.log('  ‚úì getTask(id) - Get single task');
        console.log('  ‚úì searchTasks(query) - Search by title/description');
        console.log('  ‚úì getLiveEvents(limit) - Get live feed events');
        console.log('  ‚úì autoPickupTask() - Auto-pickup highest priority task');
        console.log('  ‚úì simulateProgress() - Simulate progress updates');
        console.log('');
        console.log('Testing:');
        console.log('  ‚Ä¢ Type: testWorkshop.getTasks() - View all tasks');
        console.log('  ‚Ä¢ Type: testWorkshop.startTask("phase-2") - Start a task');
        console.log('  ‚Ä¢ Type: testWorkshop.getLiveEvents() - View live feed');
        console.log('  ‚Ä¢ Type: testWorkshop.search("dashboard") - Search tasks');
        console.log('  ‚Ä¢ Type: testWorkshop.simulateAction() - Simulate user actions');
      },
      getTasks: () => {
        const API = window.workshopManager?.constructor?.WorkshopAPI || 
          (async () => {
            const { default: api } = await import('../api/workshop.js');
            return api;
          })();
        return API.getTasks();
      },
      startTask: (id) => {
        const manager = window.workshopManager;
        if (manager) {
          manager.startTask(id);
          console.log(`‚úì Started task: ${id}`);
        }
      },
      getLiveEvents: (limit) => {
        const API = window.workshopManager?.constructor?.WorkshopAPI || 
          (async () => {
            const { default: api } = await import('../api/workshop.js');
            return api;
          })();
        return API.getLiveEvents(limit || 10);
      },
      search: (query) => {
        const manager = window.workshopManager;
        if (manager) {
          manager.searchQuery = query;
          manager.render();
          console.log(`‚úì Searching for: "${query}"`);
        }
      },
      simulateAction: async () => {
        const { default: API } = await import('../api/workshop.js');
        const manager = window.workshopManager;
        
        // Auto-pickup
        const picked = API.autoPickupTask();
        console.log(picked ? `‚úì Auto-picked: ${picked.title}` : '‚úì No pickup needed');
        
        // Simulate progress
        API.simulateProgress();
        console.log('‚úì Progress simulated');
        
        // Update UI
        if (manager) {
          manager.render();
        }
      }
    };

    // Show initial info
    window.testWorkshop.info();
  </script>
</body>
</html>
